<!doctype html><html lang=en-us><head><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js></script><script>hljs.initHighlightingOnLoad();</script><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicon-16x16.png><link rel=manifest href=/images/site.webmanifest><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A simple, minimal blog for those who love text."><title>深入理解TypeScript——文档篇之迭代器和生成器 | hackftz</title><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=https://hackftz.github.io/css/theme-override.css><header><nav><ul><li class=pull-left><a href=https://hackftz.github.io/>~/hackftz</a></li><li class=pull-left><a href=/categories/>~/categories</a></li><li class=pull-left><a href=/tags/>~/tags</a></li><li class=pull-right><a href=https://github.com/hackftz>~/github</a></li></ul></nav></header></head><body><br><div class=article-meta><h1><span class=title>深入理解TypeScript——文档篇之迭代器和生成器</span></h1><h2 class=author>hackftz</h2><h2 class=date>2020/10/28</h2><p class=terms>Categories: <a href=/categories/vue>Vue</a>
Tags: <a href=/tags/2020-10>2020-10</a></p></div><div class=content-wrapper><main><h4 id=一-可迭代性>一、 可迭代性</h4><p>定义：当一个对象实现了Symbol.iterator属性时，我们认为它是可迭代的。 一些内置的类型如 Array，Map，Set，String，Int32Array，Uint32Array等都已经实现了各自的Symbol.iterator。 对象上的 Symbol.iterator函数负责返回供迭代的值。</p><ol><li>for..of vs. for..in 语句
for..of和for..in均可迭代一个列表；但是用于迭代的<strong>值</strong>却不同。</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>list</span> <span style=color:#f92672>=</span> [<span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>6</span>];

<span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>list</span>) {
    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>i</span>); <span style=color:#75715e>// &#34;0&#34;, &#34;1&#34;, &#34;2&#34;, // for..in迭代的是对象的 键 
</span><span style=color:#75715e></span>}

<span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#a6e22e>of</span> <span style=color:#a6e22e>list</span>) {
    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>i</span>); <span style=color:#75715e>// &#34;4&#34;, &#34;5&#34;, &#34;6&#34; // for..of则迭代对象的键对应的值。
</span><span style=color:#75715e></span>}
</code></pre></div><ol start=2><li>内置对象Map和Set已经实现了Symbol.iterator方法，让我们可以访问它们保存的值。<br>但是不能在ts文件下像下面这样使用：</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pets</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Set</span>([<span style=color:#e6db74>&#34;Cat&#34;</span>, <span style=color:#e6db74>&#34;Dog&#34;</span>, <span style=color:#e6db74>&#34;Hamster&#34;</span>]);

<span style=color:#a6e22e>pets</span>[<span style=color:#e6db74>&#34;species&#34;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;mammals&#34;</span>; <span style=color:#75715e>// 元素隐式具有 &#34;any&#34; 类型，因为类型为 &#34;&#34;species&#34;&#34; 的表达式不能用于索引类型 &#34;Set&lt;string&gt;&#34;。 类型“Set&lt;string&gt;”上不存在属性“species”。
</span><span style=color:#75715e></span>
<span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pet</span> <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>pets</span>) {
    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>pet</span>); <span style=color:#75715e>// &#34;species&#34;
</span><span style=color:#75715e></span>}

<span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pet</span> <span style=color:#a6e22e>of</span> <span style=color:#a6e22e>pets</span>) {
    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>pet</span>); <span style=color:#75715e>// &#34;Cat&#34;, &#34;Dog&#34;, &#34;Hamster&#34;
</span><span style=color:#75715e></span>}
</code></pre></div><h4 id=二转es5es3>二、转es5、es3</h4><p>当生成目标为ES5或ES3，迭代器只允许在Array类型上使用。 在非数组值上使用 for..of语句会得到一个错误，就算这些非数组值已经实现了Symbol.iterator属性。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>numbers</span> <span style=color:#f92672>=</span> [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>];
<span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>num</span> <span style=color:#a6e22e>of</span> <span style=color:#a6e22e>numbers</span>) {
    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>num</span>);
}

<span style=color:#75715e>// 编译为
</span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>numbers</span> <span style=color:#f92672>=</span> [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>];
<span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>_i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>_i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>numbers</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>_i</span><span style=color:#f92672>++</span>) {
    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>num</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>numbers</span>[<span style=color:#a6e22e>_i</span>];
    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>num</span>);
}
</code></pre></div><h4 id=三es5或更高>三、es5或更高</h4><p>当目标为兼容ECMAScipt 2015的引擎时，编译器会生成相应引擎的for..of内置迭代器实现方式。</p><a href=/>>> Home</a></main></div><footer><script>(function(){function center_el(tagName){var tags=document.getElementsByTagName(tagName),i,tag;for(i=0;i<tags.length;i++){tag=tags[i];var parent=tag.parentElement;if(parent.childNodes.length===1){if(parent.nodeName==='A'){parent=parent.parentElement;if(parent.childNodes.length!=1)continue;}
if(parent.nodeName==='P')parent.style.textAlign='center';}}}
var tagNames=['img','embed','object'];for(var i=0;i<tagNames.length;i++){center_el(tagNames[i]);}})();</script><hr>公众号: KeepinJS | <a href=mailto:472849306@qq.com>Email</a></footer></body></html>
<!doctype html><html lang=en-us><head><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js></script><script>hljs.initHighlightingOnLoad();</script><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicon-16x16.png><link rel=manifest href=/images/site.webmanifest><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A simple, minimal blog for those who love text."><title>深入理解TypeScript——文档篇之模块 | hackftz</title><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=https://hackftz.github.io/css/theme-override.css><header><nav><ul><li class=pull-left><a href=https://hackftz.github.io/>~/hackftz</a></li><li class=pull-left><a href=/categories/>~/categories</a></li><li class=pull-left><a href=/tags/>~/tags</a></li><li class=pull-right><a href=https://github.com/hackftz>~/github</a></li></ul></nav></header></head><body><br><div class=article-meta><h1><span class=title>深入理解TypeScript——文档篇之模块</span></h1><h2 class=author>hackftz</h2><h2 class=date>2020/10/28</h2><p class=terms>Categories: <a href=/categories/typescript>TypeScript</a>
Tags: <a href=/tags/2020-10>2020-10</a></p></div><div class=content-wrapper><main><h4 id=一前提>一、前提</h4><p>ts1.5术语变化，“内部模块”现在称做“命名空间”。 “外部模块”现在则简称为“模块”。</p><h4 id=二介绍>二、介绍</h4><ol><li>模块在其自身的作用域里执行，而不是在全局作用域里。这意味着定义在一个模块里的变量，函数，类等等在模块外部是不可见的，除非你明确地使用export形式之一导出它们。 相反，如果想使用其它模块导出的变量，函数，类，接口等的时候，你必须要导入它们，可以使用 import形式之一。</li><li>模块是自声明的；两个模块之间的关系是通过在文件级别上使用imports和exports建立的。</li><li>模块使用模块加载器去导入其它的模块。 在运行时，模块加载器的作用是在执行此模块代码前去查找并执行这个模块的所有依赖。 大家最熟知的JavaScript模块加载器是服务于Node.js的 CommonJS和服务于Web应用的Require.js。</li><li>TypeScript与ECMAScript 2015一样，任何包含顶级import或者export的文件都被当成一个模块。相反地，如果一个文件不带有顶级的import或者export声明，那么它的内容被视为全局可见的（因此对模块也是可见的）。</li></ol><h4 id=三导出>三、导出</h4><ol><li>导出声明
任何声明（比如变量，函数，类，类型别名或接口）都能够通过添加export关键字来导出。</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>StringValidator</span> {
    <span style=color:#a6e22e>isAcceptable</span>(<span style=color:#a6e22e>s</span>: <span style=color:#66d9ef>string</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span>;
}

<span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>numberRegexp</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>/^[0-9]+$/</span>;

<span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ZipCodeValidator</span> <span style=color:#66d9ef>implements</span> <span style=color:#a6e22e>StringValidator</span> {
    <span style=color:#a6e22e>isAcceptable</span>(<span style=color:#a6e22e>s</span>: <span style=color:#66d9ef>string</span>) {
        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>5</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>numberRegexp</span>.<span style=color:#a6e22e>test</span>(<span style=color:#a6e22e>s</span>);
    }
}
</code></pre></div><ol start=2><li>导出语句（重命名）</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ZipCodeValidator</span> <span style=color:#66d9ef>implements</span> <span style=color:#a6e22e>StringValidator</span> {
    <span style=color:#a6e22e>isAcceptable</span>(<span style=color:#a6e22e>s</span>: <span style=color:#66d9ef>string</span>) {
        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>5</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>numberRegexp</span>.<span style=color:#a6e22e>test</span>(<span style=color:#a6e22e>s</span>);
    }
}
<span style=color:#66d9ef>export</span> { <span style=color:#a6e22e>ZipCodeValidator</span> };
<span style=color:#66d9ef>export</span> { <span style=color:#a6e22e>ZipCodeValidator</span> <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>mainValidator</span> };
</code></pre></div><ol start=3><li>重新导出
扩展其它模块，并且只导出那个模块的部分内容。 重新导出功能并不会在当前模块导入那个模块或定义一个新的局部变量。</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ParseIntBasedZipCodeValidator</span> {
    <span style=color:#a6e22e>isAcceptable</span>(<span style=color:#a6e22e>s</span>: <span style=color:#66d9ef>string</span>) {
        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>5</span> <span style=color:#f92672>&amp;&amp;</span> parseInt(<span style=color:#a6e22e>s</span>).<span style=color:#a6e22e>toString</span>() <span style=color:#f92672>===</span> <span style=color:#a6e22e>s</span>;
    }
}

<span style=color:#75715e>// 导出原先的验证器但做了重命名
</span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> {<span style=color:#a6e22e>ZipCodeValidator</span> <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>RegExpBasedZipCodeValidator</span>} <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;./ZipCodeValidator&#34;</span>;
</code></pre></div><p>一个模块可以包裹多个模块，并把他们导出的内容联合在一起通过语法：export * from &ldquo;module&rdquo;。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>export</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;./StringValidator&#34;</span>; <span style=color:#75715e>// exports interface StringValidator
</span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;./LettersOnlyValidator&#34;</span>; <span style=color:#75715e>// exports class LettersOnlyValidator
</span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;./ZipCodeValidator&#34;</span>;  <span style=color:#75715e>// exports class ZipCodeValidator
</span></code></pre></div><h4 id=四导入>四、导入</h4><p>模块的导入操作与导出一样简单。 可以使用以下 import形式之一来导入其它模块中的导出内容。</p><ol><li>导入一个模块中的某个导出内容</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>ZipCodeValidator</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;./ZipCodeValidator&#34;</span>;

<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>myValidator</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>ZipCodeValidator</span>();
</code></pre></div><ol start=2><li>重命名</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>ZipCodeValidator</span> <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>ZCV</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;./ZipCodeValidator&#34;</span>;
<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>myValidator</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>ZCV</span>();
</code></pre></div><ol start=3><li>将整个模块导入到一个变量，并通过它来访问模块的导出部分</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>import</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>validator</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;./ZipCodeValidator&#34;</span>;
<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>myValidator</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>validator</span>.<span style=color:#a6e22e>ZipCodeValidator</span>();
</code></pre></div><ol start=4><li>具有副作用的导入模块
不推荐这么做，一些模块会设置一些全局状态供其它模块使用。 这些模块可能没有任何的导出或用户根本就不关注它的导出。 使用下面的方法来导入这类模块。</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#34;./my-module.js&#34;</span>;
</code></pre></div><h4 id=五默认导出>五、默认导出</h4><p>每个模块都可以有一个default导出。 默认导出使用 default关键字标记；并且一个模块只能够有一个default导出。 需要使用一种特殊的导入形式来导入 default导出。</p><p>默认导出：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#75715e>// export
</span><span style=color:#75715e></span><span style=color:#66d9ef>declare</span> <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>$</span>: <span style=color:#66d9ef>JQuery</span>;

<span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>$</span>;
</code></pre></div><p>默认导入：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#75715e>// import and use
</span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>$</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;JQuery&#34;</span>;

<span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#34;button.continue&#34;</span>).<span style=color:#a6e22e>html</span>( <span style=color:#e6db74>&#34;Next Step...&#34;</span> );
</code></pre></div><p><strong>类和函数声明可以直接被标记为默认导出。 标记为默认导出的类和函数的名字是可以省略的。</strong></p><p>默认导出类：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ZipCodeValidator</span> {
    <span style=color:#66d9ef>static</span> <span style=color:#a6e22e>numberRegexp</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>/^[0-9]+$/</span>;
    <span style=color:#a6e22e>isAcceptable</span>(<span style=color:#a6e22e>s</span>: <span style=color:#66d9ef>string</span>) {
        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>5</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>ZipCodeValidator</span>.<span style=color:#a6e22e>numberRegexp</span>.<span style=color:#a6e22e>test</span>(<span style=color:#a6e22e>s</span>);
    }
}


<span style=color:#75715e>// 省略默认导出名
</span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>numberRegexp</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>/^[0-9]+$/</span>;

<span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#66d9ef>class</span> {
	<span style=color:#66d9ef>static</span> <span style=color:#a6e22e>numberRegexp</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>/^[0-9]+$/</span>;
	<span style=color:#a6e22e>isAcceptable</span>(<span style=color:#a6e22e>s</span>: <span style=color:#66d9ef>string</span>) {
			<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>5</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>numberRegexp</span>.<span style=color:#a6e22e>test</span>(<span style=color:#a6e22e>s</span>);
	}
}
</code></pre></div><p>默认导入类使用：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>validator</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;./ZipCodeValidator&#34;</span>; <span style=color:#75715e>// default
</span><span style=color:#75715e></span>
<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>myValidator</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>validator</span>();
</code></pre></div><p>默认导出函数：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>numberRegexp</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>/^[0-9]+$/</span>;

<span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>s</span>: <span style=color:#66d9ef>string</span>) {
    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>5</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>numberRegexp</span>.<span style=color:#a6e22e>test</span>(<span style=color:#a6e22e>s</span>);
}
</code></pre></div><p>默认导入函数：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>validate</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;./StaticZipCodeValidator&#34;</span>;

<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>strings</span> <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;Hello&#34;</span>, <span style=color:#e6db74>&#34;98052&#34;</span>, <span style=color:#e6db74>&#34;101&#34;</span>];

<span style=color:#75715e>// Use function validate
</span><span style=color:#75715e></span><span style=color:#a6e22e>strings</span>.<span style=color:#a6e22e>forEach</span>(<span style=color:#a6e22e>s</span> <span style=color:#f92672>=&gt;</span> {
  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`&#34;</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>s</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34; </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>validate</span>(<span style=color:#a6e22e>s</span>) <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34; matches&#34;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#34; does not match&#34;</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
});
</code></pre></div><p><strong>default导出也可以是一个值。</strong></p><p>默认导出值：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#e6db74>&#34;123&#34;</span>;
</code></pre></div><p>默认导入值：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>num</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;./OneTwoThree&#34;</span>;

<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>num</span>); <span style=color:#75715e>// &#34;123&#34;
</span></code></pre></div><h4 id=六export--和-import--require>六、export = 和 import = require()</h4><p>为了支持CommonJS和AMD的exports, TypeScript提供了export =语法。</p><p>export =语法定义一个模块的导出对象。这里的对象一词指的是类，接口，命名空间，函数或枚举。<br>==若使用export =导出一个模块，则必须使用TypeScript的特定语法import module = require(&ldquo;module&rdquo;)来导入此模块。==</p><p>导出：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>numberRegexp</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>/^[0-9]+$/</span>;
<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ZipCodeValidator</span> {
    <span style=color:#a6e22e>isAcceptable</span>(<span style=color:#a6e22e>s</span>: <span style=color:#66d9ef>string</span>) {
        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>5</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>numberRegexp</span>.<span style=color:#a6e22e>test</span>(<span style=color:#a6e22e>s</span>);
    }
}
<span style=color:#66d9ef>export</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ZipCodeValidator</span>;
</code></pre></div><p>导入：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>zip</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;./ZipCodeValidator&#34;</span>);

<span style=color:#75715e>// Some samples to try
</span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>strings</span> <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;Hello&#34;</span>, <span style=color:#e6db74>&#34;98052&#34;</span>, <span style=color:#e6db74>&#34;101&#34;</span>];

<span style=color:#75715e>// Validators to use
</span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>validator</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>zip</span>();

<span style=color:#75715e>// Show whether each string passed each validator
</span><span style=color:#75715e></span><span style=color:#a6e22e>strings</span>.<span style=color:#a6e22e>forEach</span>(<span style=color:#a6e22e>s</span> <span style=color:#f92672>=&gt;</span> {
  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`&#34;</span><span style=color:#e6db74>${</span> <span style=color:#a6e22e>s</span> <span style=color:#e6db74>}</span><span style=color:#e6db74>&#34; - </span><span style=color:#e6db74>${</span> <span style=color:#a6e22e>validator</span>.<span style=color:#a6e22e>isAcceptable</span>(<span style=color:#a6e22e>s</span>) <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34;matches&#34;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;does not match&#34;</span> <span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
});
</code></pre></div><h4 id=七生成模块代码>七、生成模块代码</h4><p>导入导出语句里使用的名字是怎么转换为相应的模块加载器代码?</p><p>ts：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>m</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;mod&#34;</span>);
<span style=color:#66d9ef>export</span> <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>t</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>something</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>;
</code></pre></div><p>AMD / RequireJS：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#a6e22e>define</span>([<span style=color:#e6db74>&#34;require&#34;</span>, <span style=color:#e6db74>&#34;exports&#34;</span>, <span style=color:#e6db74>&#34;./mod&#34;</span>], <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>require</span>, <span style=color:#a6e22e>exports</span>, <span style=color:#a6e22e>mod_1</span>) {
    <span style=color:#a6e22e>exports</span>.<span style=color:#a6e22e>t</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mod_1</span>.<span style=color:#a6e22e>something</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>;
});
</code></pre></div><p>CommonJS：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>mod_1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;./mod&#34;</span>);
<span style=color:#a6e22e>exports</span>.<span style=color:#a6e22e>t</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mod_1</span>.<span style=color:#a6e22e>something</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>;
</code></pre></div><p>Native ECMAScript 2015 modules：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>something</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;./mod&#34;</span>;
<span style=color:#66d9ef>export</span> <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>t</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>something</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>;
</code></pre></div><h4 id=八编译>八、编译</h4><p>为了编译，我们必需要在命令行上指定一个模块目标。对于Node.js来说，使用&ndash;module commonjs； 对于Require.js来说，使用&ndash;module amd。比如：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#a6e22e>tsc</span> <span style=color:#f92672>--</span><span style=color:#66d9ef>module</span> <span style=color:#a6e22e>commonjs</span> <span style=color:#a6e22e>Test</span>.<span style=color:#a6e22e>ts</span>
</code></pre></div><p>编译完成后，每个模块会生成一个单独的.js文件。 好比使用了reference标签，编译器会根据 import语句编译相应的文件。</p><h4 id=九可选的模块加载和其它高级加载场景>九、可选的模块加载和其它高级加载场景</h4><p>编译器会检测是否每个模块都会在生成的JavaScript中用到。 如果一个模块标识符只在类型注解部分使用，并且完全没有在表达式中使用时，就不会生成 require这个模块的代码。 省略掉没有用到的引用对性能提升是很有益的，并同时提供了选择性加载模块的能力。</p><p>这种模式的核心是import id = require("&mldr;")语句可以让我们访问模块导出的类型。 模块加载器会被动态调用（通过 require），就像下面if代码块里那样。 它利用了省略引用的优化，所以模块只在被需要时加载。 为了让这个模块工作，一定要注意 import定义的标识符只能在表示类型处使用（不能在会转换成JavaScript的地方）。</p><p>为了确保类型安全性，我们可以使用typeof关键字。 typeof关键字，当在表示类型的地方使用时，会得出一个类型值，这里就表示模块的类型。</p><p><strong>Node.js里的动态模块加载：</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>declare</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>require</span>(<span style=color:#66d9ef>module</span><span style=color:#a6e22e>Name</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>any</span>;

<span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>ZipCodeValidator</span> <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>Zip</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;./ZipCodeValidator&#34;</span>;

<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>needZipValidation</span>) {
    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>ZipCodeValidator</span>: <span style=color:#66d9ef>typeof</span> <span style=color:#a6e22e>Zip</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;./ZipCodeValidator&#34;</span>);
    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>validator</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>ZipCodeValidator</span>();
    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>validator</span>.<span style=color:#a6e22e>isAcceptable</span>(<span style=color:#e6db74>&#34;...&#34;</span>)) { <span style=color:#75715e>/* ... */</span> }
}
</code></pre></div><p><strong>require.js里的动态模块加载：</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>declare</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>require</span>(<span style=color:#66d9ef>module</span><span style=color:#a6e22e>Names</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span>[], <span style=color:#a6e22e>onLoad</span><span style=color:#f92672>:</span> (...<span style=color:#a6e22e>args</span>: <span style=color:#66d9ef>any</span>[]) <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>void</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span>;

<span style=color:#66d9ef>import</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>Zip</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;./ZipCodeValidator&#34;</span>;

<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>needZipValidation</span>) {
    <span style=color:#a6e22e>require</span>([<span style=color:#e6db74>&#34;./ZipCodeValidator&#34;</span>], (<span style=color:#a6e22e>ZipCodeValidator</span>: <span style=color:#66d9ef>typeof</span> <span style=color:#a6e22e>Zip</span>) <span style=color:#f92672>=&gt;</span> {
        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>validator</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>ZipCodeValidator</span>.<span style=color:#a6e22e>ZipCodeValidator</span>();
        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>validator</span>.<span style=color:#a6e22e>isAcceptable</span>(<span style=color:#e6db74>&#34;...&#34;</span>)) { <span style=color:#75715e>/* ... */</span> }
    });
}
</code></pre></div><h4 id=十使用其它的javascript库>十、使用其它的JavaScript库</h4><p>目的：要想描述非TypeScript编写的类库的类型，我们需要声明类库所暴露出的API。<br>我们叫它声明因为它不是“外部程序”的具体实现。 它们通常是在 .d.ts文件里定义的。</p><ol><li>外部模块</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>declare</span> <span style=color:#a6e22e>module</span> <span style=color:#e6db74>&#34;url&#34;</span> {
    <span style=color:#66d9ef>export</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>Url</span> {
        <span style=color:#a6e22e>protocol?</span>: <span style=color:#66d9ef>string</span>;
        <span style=color:#a6e22e>hostname?</span>: <span style=color:#66d9ef>string</span>;
        <span style=color:#a6e22e>pathname?</span>: <span style=color:#66d9ef>string</span>;
    }

    <span style=color:#66d9ef>export</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>parse</span>(<span style=color:#a6e22e>urlStr</span>: <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>parseQueryString</span><span style=color:#f92672>?</span>, <span style=color:#a6e22e>slashesDenoteHost</span><span style=color:#f92672>?</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Url</span>;
}

<span style=color:#66d9ef>declare</span> <span style=color:#a6e22e>module</span> <span style=color:#e6db74>&#34;path&#34;</span> {
    <span style=color:#66d9ef>export</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>normalize</span>(<span style=color:#a6e22e>p</span>: <span style=color:#66d9ef>string</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span>;
    <span style=color:#66d9ef>export</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>join</span>(...<span style=color:#a6e22e>paths</span>: <span style=color:#66d9ef>any</span>[])<span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span>;
    <span style=color:#66d9ef>export</span> <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>sep</span>: <span style=color:#66d9ef>string</span>;
}
</code></pre></div><p>现在我们可以/// node.d.ts并且使用import url = require(&ldquo;url&rdquo;);或import * as URL from &ldquo;url"加载模块。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#75715e>/// &lt;reference path=&#34;node.d.ts&#34;/&gt;
</span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>URL</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;url&#34;</span>;
<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>myUrl</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>URL</span>.<span style=color:#a6e22e>parse</span>(<span style=color:#e6db74>&#34;http://www.typescriptlang.org&#34;</span>);
</code></pre></div><ol start=2><li>外部模块简写（推荐）
假如你不想在使用一个新模块之前花时间去编写声明，你可以采用声明的简写形式以便能够快速使用它。</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>declare</span> <span style=color:#a6e22e>module</span> <span style=color:#e6db74>&#34;hot-new-module&#34;</span>;
</code></pre></div><p>简写模块里所有导出的类型将是any。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>x</span>, {<span style=color:#a6e22e>y</span>} <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;hot-new-module&#34;</span>;
<span style=color:#a6e22e>x</span>(<span style=color:#a6e22e>y</span>);
</code></pre></div><ol start=3><li>模块声明通配符<br>某些模块加载器如SystemJS 和 AMD支持导入非JavaScript内容。 它们通常会使用一个前缀或后缀来表示特殊的加载语法。 模块声明通配符可以用来表示这些情况。</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>declare</span> <span style=color:#a6e22e>module</span> <span style=color:#e6db74>&#34;*!text&#34;</span> {
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>content</span>: <span style=color:#66d9ef>string</span>;
    <span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>content</span>;
}
<span style=color:#75715e>// Some do it the other way around.
</span><span style=color:#75715e></span><span style=color:#66d9ef>declare</span> <span style=color:#a6e22e>module</span> <span style=color:#e6db74>&#34;json!*&#34;</span> {
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>value</span>: <span style=color:#66d9ef>any</span>;
    <span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>value</span>;
}
</code></pre></div><p>使用：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>fileContent</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;./xyz.txt!text&#34;</span>;
<span style=color:#66d9ef>import</span> <span style=color:#a6e22e>data</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;json!http://example.com/data.json&#34;</span>;
<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>data</span>, <span style=color:#a6e22e>fileContent</span>);
</code></pre></div><ol start=4><li>UMD模块
有些模块被设计成兼容多个模块加载器，或者不使用模块加载器（全局变量）。 它们以 UMD模块为代表。 这些库可以通过导入的形式或全局变量的形式访问。例如：</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>isPrime</span>(<span style=color:#a6e22e>x</span>: <span style=color:#66d9ef>number</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span>;
<span style=color:#66d9ef>export</span> <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>namespace</span> <span style=color:#a6e22e>mathLib</span>;
</code></pre></div><p>使用：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>isPrime</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;math-lib&#34;</span>;
<span style=color:#a6e22e>isPrime</span>(<span style=color:#ae81ff>2</span>);
<span style=color:#a6e22e>mathLib</span>.<span style=color:#a6e22e>isPrime</span>(<span style=color:#ae81ff>2</span>); 
</code></pre></div><h4 id=十一创建模块结构指导>十一、创建模块结构指导</h4><ol><li>如果仅导出单个 class 或 function，使用 export default</li></ol><p>导出：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SomeType</span> {
  <span style=color:#66d9ef>constructor</span>() { ... }
}
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getThing() {</span> <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;thing&#39;</span>; }
</code></pre></div><p>导入：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>t</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;./MyClass&#34;</span>;
<span style=color:#66d9ef>import</span> <span style=color:#a6e22e>f</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;./MyFunc&#34;</span>;
<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>t</span>();
<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>f</span>());
</code></pre></div><ol start=2><li>如果要导出多个对象，把它们放在顶层里导出</li></ol><p>导出：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SomeType</span> { <span style=color:#75715e>/* ... */</span> }
<span style=color:#66d9ef>export</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>someFunc() {</span> <span style=color:#75715e>/* ... */</span> }
</code></pre></div><p>导入：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>SomeType</span>, <span style=color:#a6e22e>someFunc</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;./MyThings&#34;</span>;
<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>SomeType</span>();
<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>someFunc</span>();
</code></pre></div><ol start=3><li>使用命名空间导入模式当你要导出大量内容的时候</li></ol><p>导出：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Dog</span> { ... }
<span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Cat</span> { ... }
<span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Tree</span> { ... }
<span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Flower</span> { ... }
</code></pre></div><p>导入：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>import</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>myLargeModule</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;./MyLargeModule.ts&#34;</span>;
<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>myLargeModule</span>.<span style=color:#a6e22e>Dog</span>();
</code></pre></div><ol start=4><li><p>使用重新导出进行扩展<br>你可能经常需要去扩展一个模块的功能。 JS里常用的一个模式是JQuery那样去扩展原对象。 如我们之前提到的，模块不会像全局命名空间对象那样去 合并。 推荐的方案是 不要去改变原来的对象，而是导出一个新的实体来提供新的功能。</p></li><li><p>模块里不要使用命名空间<br>当初次进入基于模块的开发模式时，可能总会控制不住要将导出包裹在一个命名空间里。 模块具有其自己的作用域，并且只有导出的声明才会在模块外部可见。 记住这点，命名空间在使用模块时几乎没什么价值。</p></li><li><p>危险信号
以下均为模块结构上的危险信号。重新检查以确保你没有在对模块使用命名空间：</p></li></ol><ul><li>文件的顶层声明是export namespace Foo { &mldr; } （删除Foo并把所有内容向上层移动一层）</li><li>文件只有一个export class或export function （考虑使用export default）</li><li>多个文件的顶层具有同样的export namespace Foo { （不要以为这些会合并到一个Foo中！）</li></ul><a href=/>>> Home</a></main></div><footer><script>(function(){function center_el(tagName){var tags=document.getElementsByTagName(tagName),i,tag;for(i=0;i<tags.length;i++){tag=tags[i];var parent=tag.parentElement;if(parent.childNodes.length===1){if(parent.nodeName==='A'){parent=parent.parentElement;if(parent.childNodes.length!=1)continue;}
if(parent.nodeName==='P')parent.style.textAlign='center';}}}
var tagNames=['img','embed','object'];for(var i=0;i<tagNames.length;i++){center_el(tagNames[i]);}})();</script><hr>公众号: KeepinJS | <a href=mailto:472849306@qq.com>Email</a></footer></body></html>